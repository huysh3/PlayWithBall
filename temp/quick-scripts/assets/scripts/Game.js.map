{"version":3,"sources":["Game.js"],"names":["cc","Class","extends","Component","properties","scoreDisplay","default","type","Label","starPrefab","Prefab","maxStarDuration","minStarDuration","ground","Node","player","pickAudio","url","AudioClip","onLoad","groundY","y","height","score","timer","starDuration","spawnNewStar","newStar","instantiate","node","addChild","setPosition","getNewStarPosition","random0To1","getComponent","game","randX","randY","jumpHeight","maxX","width","randomMinus1To1","p","gainScore","string","toString","playPickedSound","audioEngine","playEffect","start","gameOver","stopAllActions","director","loadScene","update","dt"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,WAASF,GAAGG,SADP;;AAGLC,cAAY;AACVC,kBAAc;AACZC,eAAS,IADG;AAEZC,YAAMP,GAAGQ;AAFG,KADJ;;AAMVC,gBAAY;AACVH,eAAS,IADC;AAEVC,YAAMP,GAAGU;AAFC,KANF;;AAWV;AACAC,qBAAiB,CAZP;AAaVC,qBAAiB,CAbP;;AAeV;AACAC,YAAQ;AACNP,eAAS,IADH;AAENC,YAAMP,GAAGc;AAFH,KAhBE;;AAsBV;AACAC,YAAQ;AACNT,eAAS,IADH;AAENC,YAAMP,GAAGc;AAFH,KAvBE;;AA4BVE,eAAW;AACTV,eAAS,IADA;AAETW,WAAKjB,GAAGkB;AAFC;AA5BD,GAHP;;AAqCL;;AAEAC,QAvCK,oBAuCK;AACR;AACA,SAAKC,OAAL,GAAe,KAAKP,MAAL,CAAYQ,CAAZ,GAAgB,KAAKR,MAAL,CAAYS,MAAZ,GAAqB,CAApD;;AAEA,SAAKC,KAAL,GAAa,CAAb;;AAEA;AACA,SAAKC,KAAL,GAAa,CAAb;AACA,SAAKC,YAAL,GAAoB,CAApB;;AAEA;AACA,SAAKC,YAAL;AACD,GAnDI;AAqDLA,cArDK,0BAqDW;AACd;AACA,QAAIC,UAAU3B,GAAG4B,WAAH,CAAe,KAAKnB,UAApB,CAAd;;AAEA,SAAKoB,IAAL,CAAUC,QAAV,CAAmBH,OAAnB;;AAEAA,YAAQI,WAAR,CAAoB,KAAKC,kBAAL,EAApB;AACA,SAAKP,YAAL,GAAoB,KAAKb,eAAL,GAAuBZ,GAAGiC,UAAH,MAAmB,KAAKtB,eAAL,GAAuB,KAAKC,eAA/C,CAA3C;AACA,SAAKY,KAAL,GAAa,CAAb;;AAEAG,YAAQO,YAAR,CAAqB,MAArB,EAA6BC,IAA7B,GAAoC,IAApC;AACD,GAhEI;AAkELH,oBAlEK,gCAkEiB;AACpB,QAAII,QAAQ,CAAZ;;AAEA,QAAIC,QAAQ,KAAKjB,OAAL,GAAepB,GAAGiC,UAAH,KAAkB,KAAKlB,MAAL,CAAYmB,YAAZ,CAAyB,QAAzB,EAAmCI,UAAhF;AACA;;AAEA,QAAIC,OAAO,KAAKV,IAAL,CAAUW,KAAV,GAAkB,CAA7B;AACAJ,YAAQpC,GAAGyC,eAAH,KAAuBF,IAA/B;;AAEA,WAAOvC,GAAG0C,CAAH,CAAKN,KAAL,EAAYC,KAAZ,CAAP;AACD,GA5EI;AA8ELM,WA9EK,uBA8EQ;AACX,SAAKpB,KAAL,IAAc,CAAd;AACA,SAAKlB,YAAL,CAAkBuC,MAAlB,eAAqC,KAAKrB,KAAL,CAAWsB,QAAX,EAArC;AACA,SAAKC,eAAL;AACD,GAlFI;AAoFLA,iBApFK,6BAoFc;AACjB9C,OAAG+C,WAAH,CAAeC,UAAf,CAA0B,KAAKhC,SAA/B,EAA0C,KAA1C;AACD,GAtFI;AAwFLiC,OAxFK,mBAwFI,CAER,CA1FI;AA4FLC,UA5FK,sBA4FO;AACV,SAAKnC,MAAL,CAAYoC,cAAZ;AACAnD,OAAGoD,QAAH,CAAYC,SAAZ,CAAsB,MAAtB;AACD,GA/FI;AAiGLC,QAjGK,kBAiGGC,EAjGH,EAiGO;AACV,QAAI,KAAK/B,KAAL,GAAa,KAAKC,YAAtB,EAAoC;AAClC,WAAKyB,QAAL;AACA,aAAO,KAAP;AACD;AACD,SAAK1B,KAAL,IAAc+B,EAAd;AACD;AAvGI,CAAT","file":"Game.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n      scoreDisplay: {\n        default: null,\n        type: cc.Label\n      },\n\n      starPrefab: {\n        default: null,\n        type: cc.Prefab\n      },\n\n      // 星星保质期\n      maxStarDuration: 0,\n      minStarDuration: 0,\n\n      // 地面节点, 用于确定星星生成高度\n      ground: {\n        default: null,\n        type: cc.Node\n      },\n\n\n      // player节点，用于获取主角弹跳高度\n      player: {\n        default: null,\n        type: cc.Node\n      },\n\n      pickAudio: {\n        default: null,\n        url: cc.AudioClip\n      },\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n      // 获取地平面的y轴坐标\n      this.groundY = this.ground.y + this.ground.height / 2\n\n      this.score = 0\n\n      // 计时器\n      this.timer = 0\n      this.starDuration = 0\n\n      // 生成星星\n      this.spawnNewStar()\n    },\n\n    spawnNewStar () {\n      // 使用给定的模板在场景中生成新Node\n      let newStar = cc.instantiate(this.starPrefab)\n\n      this.node.addChild(newStar)\n\n      newStar.setPosition(this.getNewStarPosition())\n      this.starDuration = this.minStarDuration + cc.random0To1() * (this.maxStarDuration - this.minStarDuration)\n      this.timer = 0\n\n      newStar.getComponent('Star').game = this\n    },\n\n    getNewStarPosition () {\n      let randX = 0\n\n      let randY = this.groundY + cc.random0To1() * this.player.getComponent('Player').jumpHeight\n      // let randY = this.groundY\n\n      let maxX = this.node.width / 2\n      randX = cc.randomMinus1To1() * maxX\n\n      return cc.p(randX, randY)\n    },\n\n    gainScore () {\n      this.score += 1\n      this.scoreDisplay.string = `Score: ${this.score.toString()}`\n      this.playPickedSound()\n    },\n\n    playPickedSound () {\n      cc.audioEngine.playEffect(this.pickAudio, false)\n    },\n\n    start () {\n\n    },\n\n    gameOver () {\n      this.player.stopAllActions()\n      cc.director.loadScene('game')\n    },\n\n    update (dt) {\n      if (this.timer > this.starDuration) {\n        this.gameOver()\n        return false\n      }\n      this.timer += dt\n    },\n});\n"]}